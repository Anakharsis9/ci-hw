name: Create release
permissions:
  contents: read
  issues: write
on: 
  push:
    tags:
      - v\d+
jobs:
  create-issue:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Create an issue
        run: echo "CREATION_DATE=$(date +'%d.%m.%Y %H:%M:%S')" >> $GITHUB_ENV
      - name: Create an issue
        id: create-issue
        uses: JasonEtco/create-an-issue@v2.9.1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          version: ${{ github.ref_name }}
          author: ${{ github.actor }}
          date: $CREATION_DATE
        with:
            update_existing: true
            search_existing: all
      - run: 'echo Created ${{ steps.create-issue.outputs.url }}'
  run-autotests:
    uses: ./.github/workflows/testing.yml
      
